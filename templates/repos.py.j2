from typing import Iterable

from sqlalchemy import text
from sqlalchemy.engine import Engine

{% for table in tables %}
class {{ to_pascal(table.table_name) }}Repository:
    def __init__(self, engine: Engine) -> None:
        self._engine = engine

    def fetch_all(self) -> list[dict]:
        statement = text('SELECT * FROM "{{ table.table_name }}"')
        with self._engine.connect() as connection:
            result = connection.execute(statement)
            return list(result.mappings())

{% endfor %}
